(()=>{var e={};e.id=4564,e.ids=[4564],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6330:e=>{"use strict";e.exports=require("@prisma/client")},6487:()=>{},6580:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>p,serverHooks:()=>k,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>d});var i={};r.r(i),r.d(i,{GET:()=>l,POST:()=>c});var s=r(6559),a=r(8088),n=r(7719),o=r(2190);let u=new(r(6330)).PrismaClient;async function l(e){try{let t,r=e.nextUrl.searchParams.get("sirket_id");return t=r?await u.sirketFiyatListesi.findMany({where:{sirket_id:parseInt(r)},include:{sirket:{select:{sirket_adi:!0}}},orderBy:{tahliye_yeri:"asc"}}):await u.sirketFiyatListesi.findMany({include:{sirket:{select:{sirket_adi:!0}}},orderBy:{tahliye_yeri:"asc"}}),o.NextResponse.json(t)}catch(e){return console.error("Fiyat listesi getirme hatası:",e),o.NextResponse.json({error:"Fiyat listesi alınırken bir hata oluştu"},{status:500})}}async function c(e){try{let{sirket_id:t,fiyatlar:r}=await e.json();if(!t||!r||!Array.isArray(r)||0===r.length)return o.NextResponse.json({error:"Ge\xe7ersiz veri formatı. Şirket ID ve fiyat listesi gereklidir."},{status:400});console.log("Fiyat listesi ekleme isteği:",JSON.stringify(r,null,2));let i=[];for(let e of r){let r,s=await u.sirketFiyatListesi.findFirst({where:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,arac_tipi:e.arac_tipi}});r=s?await u.sirketFiyatListesi.update({where:{fiyat_listesi_id:s.fiyat_listesi_id},data:{ucret:e.ucret,sofor_ucreti:e.sofor_ucreti,km:e.km||null}}):await u.sirketFiyatListesi.create({data:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,arac_tipi:e.arac_tipi,ucret:e.ucret,sofor_ucreti:e.sofor_ucreti,km:e.km||null}}),i.push(r)}return o.NextResponse.json({message:"Fiyat listesi başarıyla kaydedildi",items:i})}catch(e){return console.error("Fiyat listesi ekleme hatası:",e),o.NextResponse.json({error:"Fiyat listesi eklenirken bir hata oluştu: "+(e instanceof Error?e.message:String(e))},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/fiyat-listesi/sirket/route",pathname:"/api/fiyat-listesi/sirket",filename:"route",bundlePath:"app/api/fiyat-listesi/sirket/route"},resolvedPagePath:"/Users/yusufmertyavuz/Desktop/nakliyeemm/src/app/api/fiyat-listesi/sirket/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:y,workUnitAsyncStorage:d,serverHooks:k}=p;function f(){return(0,n.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:d})}},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[4447,580],()=>r(6580));module.exports=i})();