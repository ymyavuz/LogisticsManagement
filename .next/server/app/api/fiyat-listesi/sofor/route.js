(()=>{var e={};e.id=7501,e.ids=[7501],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1567:(e,t,i)=>{"use strict";i.r(t),i.d(t,{patchFetch:()=>f,routeModule:()=>d,serverHooks:()=>p,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>k});var r={};i.r(r),i.d(r,{GET:()=>u,POST:()=>l});var s=i(6559),a=i(8088),o=i(7719),n=i(2190);let y=new(i(6330)).PrismaClient;async function u(e){try{let t,i=e.nextUrl.searchParams.get("sirket_id"),r=(i?await y.sirketFiyatListesi.findMany({where:{sirket_id:parseInt(i),sofor_ucreti:{not:null}},include:{sirket:{select:{sirket_adi:!0}}},orderBy:{tahliye_yeri:"asc"}}):await y.sirketFiyatListesi.findMany({where:{sofor_ucreti:{not:null}},include:{sirket:{select:{sirket_adi:!0}}},orderBy:{tahliye_yeri:"asc"}})).map(e=>({...e,ucret:e.sofor_ucreti}));return n.NextResponse.json(r)}catch(e){return console.error("Fiyat listesi getirme hatası:",e),n.NextResponse.json({error:"Fiyat listesi alınırken bir hata oluştu"},{status:500})}}async function l(e){try{let{sirket_id:t,fiyatlar:i}=await e.json();if(!t||!i||!Array.isArray(i)||0===i.length)return n.NextResponse.json({error:"Ge\xe7ersiz veri formatı. Şirket ID ve fiyat listesi gereklidir."},{status:400});let r=[];for(let e of i){if(void 0!==e.tir_fiyati&&null!==e.tir_fiyati){let i,s=await y.sirketFiyatListesi.findFirst({where:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,arac_tipi:"Tır"}});i=s?await y.sirketFiyatListesi.update({where:{fiyat_listesi_id:s.fiyat_listesi_id},data:{sofor_ucreti:e.tir_fiyati}}):await y.sirketFiyatListesi.create({data:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,km:e.km,arac_tipi:"Tır",ucret:0,sofor_ucreti:e.tir_fiyati}}),r.push(i)}if(void 0!==e.kirkayak_fiyati&&null!==e.kirkayak_fiyati){let i,s=await y.sirketFiyatListesi.findFirst({where:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,arac_tipi:"Kırkayak"}});i=s?await y.sirketFiyatListesi.update({where:{fiyat_listesi_id:s.fiyat_listesi_id},data:{sofor_ucreti:e.kirkayak_fiyati}}):await y.sirketFiyatListesi.create({data:{sirket_id:t,tahliye_yeri:e.tahliye_yeri,km:e.km,arac_tipi:"Kırkayak",ucret:0,sofor_ucreti:e.kirkayak_fiyati}}),r.push(i)}}return n.NextResponse.json({message:"Fiyat listesi başarıyla kaydedildi",items:r})}catch(e){return console.error("Fiyat listesi ekleme hatası:",e),n.NextResponse.json({error:"Fiyat listesi eklenirken bir hata oluştu"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/fiyat-listesi/sofor/route",pathname:"/api/fiyat-listesi/sofor",filename:"route",bundlePath:"app/api/fiyat-listesi/sofor/route"},resolvedPagePath:"/Users/yusufmertyavuz/Desktop/nakliyeemm/src/app/api/fiyat-listesi/sofor/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:c,workUnitAsyncStorage:k,serverHooks:p}=d;function f(){return(0,o.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:k})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6330:e=>{"use strict";e.exports=require("@prisma/client")},6487:()=>{},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[4447,580],()=>i(1567));module.exports=r})();